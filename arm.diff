# HG changeset patch
# Parent 6b1b8174ce29396d7dbd482296f43eba38948222
Support for arm-linux-musl.

diff -r 6b1b8174ce29 gcc/config/arm/linux-eabi.h
--- a/gcc/config/arm/linux-eabi.h	Fri Mar 29 16:41:20 2013 -0400
+++ b/gcc/config/arm/linux-eabi.h	Fri Mar 29 16:41:23 2013 -0400
@@ -77,6 +77,10 @@
     %{mfloat-abi=soft*:" GLIBC_DYNAMIC_LINKER_SOFT_FLOAT "} \
     %{!mfloat-abi=*:" GLIBC_DYNAMIC_LINKER_DEFAULT "}"
 
+/* musl has no "classic" (i.e. broken) mode */
+#undef  MUSL_DYNAMIC_LINKER
+#define MUSL_DYNAMIC_LINKER "/lib/ld-musl-arm.so.1"
+
 /* At this point, bpabi.h will have clobbered LINK_SPEC.  We want to
    use the GNU/Linux version, not the generic BPABI version.  */
 #undef  LINK_SPEC
diff -r 6b1b8174ce29 libitm/config/arm/hwcap.cc
--- a/libitm/config/arm/hwcap.cc	Fri Mar 29 16:41:20 2013 -0400
+++ b/libitm/config/arm/hwcap.cc	Fri Mar 29 16:41:23 2013 -0400
@@ -40,7 +40,11 @@
 
 #ifdef __linux__
 #include <unistd.h>
+#ifdef __GLIBC__
 #include <sys/fcntl.h>
+#else
+#include <fcntl.h>
+#endif
 #include <elf.h>
 
 static void __attribute__((constructor))
