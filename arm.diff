# HG changeset patch
# Parent 8801a3f6d0501c6cf72b68141b12d8452759d565
Support for arm-linux-musl.

diff -r 8801a3f6d050 gcc/config/arm/linux-eabi.h
--- a/gcc/config/arm/linux-eabi.h	Tue Aug 27 15:47:31 2013 -0400
+++ b/gcc/config/arm/linux-eabi.h	Tue Aug 27 15:47:37 2013 -0400
@@ -64,6 +64,10 @@
 #undef  GLIBC_DYNAMIC_LINKER
 #define GLIBC_DYNAMIC_LINKER "/lib/ld-linux.so.3"
 
+/* musl has no "classic" (i.e. broken) mode */
+#undef  MUSL_DYNAMIC_LINKER
+#define MUSL_DYNAMIC_LINKER "/lib/ld-musl-arm.so.1"
+
 /* At this point, bpabi.h will have clobbered LINK_SPEC.  We want to
    use the GNU/Linux version, not the generic BPABI version.  */
 #undef  LINK_SPEC
diff -r 8801a3f6d050 libitm/config/arm/hwcap.cc
--- a/libitm/config/arm/hwcap.cc	Tue Aug 27 15:47:31 2013 -0400
+++ b/libitm/config/arm/hwcap.cc	Tue Aug 27 15:47:37 2013 -0400
@@ -40,7 +40,11 @@
 
 #ifdef __linux__
 #include <unistd.h>
+#ifdef __GLIBC__
 #include <sys/fcntl.h>
+#else
+#include <fcntl.h>
+#endif
 #include <elf.h>
 
 static void __attribute__((constructor))
